{
    "version": 2,
    "description": "Field update benchmark",
    "indices": [
        {
            "name": "books",
            {#"body": "books_index.json",#}
            "types": [ "books" ]
        }
    ],
    "challenges": [
        {
            "name": "field-update-scenario",
            {% set docs=1000000000 %}
            "default": true,
            "schedule": [
                {
                    "operation": {
                        "operation-type": "delete-index"
                    }
                },
                {
                    "operation": {
                        "operation-type": "create-index",
                          "index": "books",
                          "body": {
                            "settings": {
                              "index.number_of_shards": 100
                            },
                            "mappings": {
                                "books": {
                                  "dynamic": "strict",
                                  "properties": {
                                    "title": {
                                      "type": "text"
                                    },
                                    "abstract": {
                                      "type": "text"
                                    },
                                    "author": {
                                      "type": "text"
                                    },
                                    "pubDate": {
                                      "type": "text"
                                    },
                                    "subscriptions": {
                                      "type":"keyword"
                                    },
                                    "updated": {
                                      "type": "boolean"
                                    }
                                  }
                                }
                              }
                          }
                    }
                },
                {
                    "operation": {
                        "name": "bulk-insert",
                        "operation-type": "bulk",
                        {% set bulksize=1000 %}
                        "bulk-size":{{bulksize}},
                        "param-source": "insert-books-subscription",
                        "subs-total":200000,
                        "subs-per-book":100 
                        {#"not-in use- num docs in subscription":500000#}
                    },
                    "clients": 1,
                    "iterations": {{docs/bulksize}}
                }{#,
                {
                    "parallel": {
                        "completed-by":"bulk-update",
                        "tasks": [
                            {
                                "operation": {
                                    "name": "randomized search",
                                    "operation-type": "search",
                                    "param-source": "search-param-source",
                                    "titles":{% include 'titles.txt' %},
                                    "subscriptions":{% include 'subscriptions.txt' %}
                                },
                                "clients": 1,
                                "target-throughput": 1
                            },
                            {
                                "operation": {
                                    "name": "bulk-update",
                                    "operation-type": "bulk",
                                    "bulk_size":100,
                                    "param-source": "update-param-source",
                                    "num_ids":1255614,
                                    "subscriptions":{% include 'subscriptions.txt' %}
                                },
                                "clients": 1,
                                "iterations": 12556
                            }

                        ]
                    }
                }#}
            ]
        }
    ]
}

